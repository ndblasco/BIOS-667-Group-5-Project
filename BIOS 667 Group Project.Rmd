---
title: "BIOS 667 Group Project"
author: 
- Lily Bai
- Nathalie Blasco
- Yihao Peng
- Lauren Rackley
- Sirui Wu
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
    keep_tex: true
---

```{r,echo=FALSE}
# Load packages
suppressPackageStartupMessages({
library(haven) # for reading in data 
library(dplyr) # for manipulating data
library(gtsummary) # for making table 1
library(cards)
library(kableExtra)
library(huxtable) # for styling tables
})

# Read the SPSS file
cdystonia <- read_dta("/Users/laurenrackley/Downloads/cdystonia.dta")

# Inspect data
#head(cdystonia)

cdystonia <- cdystonia %>% mutate(
    trt = case_when(
      treat == 1 ~ "10000U",
      treat == 2 ~ "5000U",
      treat == 3 ~ "Placebo"
    ),
    trt = factor(trt, levels = c("Placebo", "5000U", "10000U")),
    sexc = case_when(
      sex == 1 ~ "Female",
      sex == 2 ~ "Male"))

# Filter to only week 0
cdystonia_wk0 <- cdystonia %>%
  filter(week == 0)

tbl <- cdystonia_wk0 |>
  tbl_summary(by = trt, 
              include = c(sexc, age,twstrs),
              type=all_continuous()~"continuous2",
              label = list(sexc = "Sex",age~"Age (years)",twstrs="TWSTRS total score at baseline"),
              statistic = list(
      age ~ c(
      "{N_obs}",
      "{mean} ({sd})",
      "{median}",
      "{min},{max}"),
      all_categorical() ~ "{n} ({p}%)",
      twstrs~"{mean} ({sd})")) |>
  add_p() |>
  modify_footnote(
    all_stat_cols() ~ "TWSTRS = Toronto Western Spasmodic Torticollis Rating Scale",
    abbreviation = TRUE
  )

as_kable_extra(tbl,
               booktabs=TRUE,
               longtable=TRUE,
               linesep="",
               caption = "Patient Characteristics at Baseline")

```

